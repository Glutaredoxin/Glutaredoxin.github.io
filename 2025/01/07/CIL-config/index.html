<!DOCTYPE html>
<html>
    <!-- Head -->
    <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="author" content="Glutaredoxin">
    <meta name="description" itemprop="description" content="">
    <meta name="keywords" content="">

    <!-- Page Title -->
    
        <title>CIL_config | Glutaredoxin&#39;log</title>
    
    <link rel="icon" href="/img/strawberry.png">
    <link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.css">
    <script src="https://cdn.staticfile.org/jquery/3.2.1/jquery.min.js"></script>
    <link href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
    
    <script src="//cdn.bootcss.com/prettify/r298/prettify.min.js" type="text/javascript"></script>
    <link rel="stylesheet" href="/css/google-prettify-monokai.css" type="text/css">
    
    
<script src="/js/script.js"></script>

    
<link rel="stylesheet" href="/css/style.css">

    
    <style>
        .deactiveColor{
            color: #37474f;
        }
        .activeColor{
            color: #006064;
        }
        a:hover{
            color: #006064;
        }
        .header-btn{
            color: #37474f;
        }
        
        .post-content img{
            margin: 50px auto;
        }
        
    </style>
<meta name="generator" content="Hexo 7.3.0"></head>
    <body>
        <div class="container">

            <!-- Top Anchor -->
            <div id="top"></div>

            <!-- Header -->
            <header class="header-wrapper">
    <div class="header-title-wrapper">
        <!-- Page Title -->
        <p class="header-title">
             
                
                    CIL_config
                
            
        </p>  
    </div>    

    
        <!-- Division Line -->
        <div class="division"></div> 
    
    
    <div class="header-detail">
        <!-- Header Button -->
        <div class="header-btn-wrapper">
            
                <span>
                    <a class="home-btn header-btn" href="/" title="homepage"><i class="fa fa-home"></i></a>
                </span>

                
                    <span>
                        <a class="catalog-btn header-btn"><i class="fa fa-list-ul"></i></a>
                    </span>
                
            
        </div>
    </div>
</header>

            <!-- Main -->
            <main>
                <article class="post-wrapper">
    

    
        <!-- Article Catalog -->
        <div class="catalog-dropdown col-xs-12 col-sm-12">
            <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%F0%9F%A5%95-CIL-config"><span class="toc-number">1.</span> <span class="toc-text">ğŸ¥• CIL config</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%B8-CIFAR-100"><span class="toc-number">1.1.</span> <span class="toc-text">ğŸ”¸ CIFAR 100</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%B8-TinyImageNet100"><span class="toc-number">1.2.</span> <span class="toc-text">ğŸ”¸ TinyImageNet100</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%B8-ImageNet100"><span class="toc-number">1.3.</span> <span class="toc-text">ğŸ”¸ ImageNet100</span></a></li></ol></li></ol>
        </div>
    

    
        <!--For now, Lightbox Only Show in Post Layout -->
        

        
        
            <!-- Article Img Lightbox -->
            <div class="gallery">
    
    
    <div class="lightbox">
        <!-- Close Button -->
        <span class="close-gallery">&times;</span>
        
        <!-- Photo -->
        <img class="gallery-photo">
    </div>
</div>
        
    

    

    <!-- Article Content -->
    <div class="post-content">
        <h1 id="ğŸ¥•-CIL-config"><a href="#ğŸ¥•-CIL-config" class="headerlink" title="ğŸ¥• CIL config"></a>ğŸ¥• CIL config</h1><h2 id="ğŸ”¸-CIFAR-100"><a href="#ğŸ”¸-CIFAR-100" class="headerlink" title="ğŸ”¸ CIFAR 100"></a>ğŸ”¸ CIFAR 100</h2><p>config:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"># DEVICE and SEED</span><br><span class="line">parser.add_argument(&#x27;--device&#x27;, default=&#x27;cuda&#x27;)</span><br><span class="line">parser.add_argument(&#x27;--seed&#x27;, default=213, type=int)</span><br><span class="line"></span><br><span class="line"># DISTRIBUTION</span><br><span class="line">parser.add_argument(&#x27;--distributed&#x27;, default=False, type=bool)</span><br><span class="line"></span><br><span class="line"># TRANSFORM</span><br><span class="line">parser.add_argument(&#x27;--input_size&#x27;, type=int, default=32)</span><br><span class="line">parser.add_argument(&#x27;--color_jitter&#x27;, default=0.4, type=float, metavar=&#x27;NAME&#x27;)</span><br><span class="line">parser.add_argument(&#x27;--aa&#x27;, type=str, default=&#x27;rand-m9-mstd0.5-inc1&#x27;, metavar=&#x27;NAME&#x27;)</span><br><span class="line">parser.add_argument(&#x27;--reprob&#x27;, type=float, default=0.0, metavar=&#x27;PCT&#x27;)</span><br><span class="line">parser.add_argument(&#x27;--remode&#x27;, type=str, default=&#x27;pixel&#x27;)</span><br><span class="line">parser.add_argument(&#x27;--recount&#x27;, type=int, default=1)</span><br><span class="line">parser.add_argument(&#x27;--resplit&#x27;, default=False)</span><br><span class="line">parser.add_argument(&#x27;--repeated_aug&#x27;, type=bool, default=True)</span><br><span class="line">parser.add_argument(&#x27;--smoothing&#x27;, default=0.1, type=int)</span><br><span class="line">parser.add_argument(&#x27;--train_interpolation&#x27;, default=&quot;bicubic&quot;, type=str)</span><br><span class="line"></span><br><span class="line"># LOSS</span><br><span class="line">parser.add_argument(&#x27;--lr&#x27;, default=0.0001, type=float)</span><br><span class="line">parser.add_argument(&#x27;--incremental_lr&#x27;, type=float, default=0.0001)</span><br><span class="line">parser.add_argument(&#x27;--distillation_t&#x27;, type=float, default=1.0)</span><br><span class="line">parser.add_argument(&#x27;--no_amp&#x27;, default=True, action=&#x27;store_true&#x27;)</span><br><span class="line">parser.add_argument(&#x27;--opt&#x27;, default=&#x27;adamw&#x27;)</span><br><span class="line">parser.add_argument(&#x27;--weight_decay&#x27;, type=float, default=1e-06)</span><br><span class="line">parser.add_argument(&#x27;--momentum&#x27;, type=float, default=0.9)</span><br><span class="line">parser.add_argument(&#x27;--sched&#x27;, default=&#x27;cosine&#x27;)</span><br><span class="line">parser.add_argument(&#x27;--opt_eps&#x27;, type=float, default=1e-08)</span><br><span class="line">parser.add_argument(&#x27;--decay_epochs&#x27;, type=int, default=30)</span><br><span class="line">parser.add_argument(&#x27;--warmup_epochs&#x27;, type=int, default=5)</span><br><span class="line">parser.add_argument(&#x27;--cooldown_epochs&#x27;, default=10, type=int)</span><br><span class="line">parser.add_argument(&#x27;--patience_epochs&#x27;, default=10, type=int)</span><br><span class="line">parser.add_argument(&#x27;--decay_rate&#x27;, type=float, default=0.1)</span><br><span class="line">parser.add_argument(&#x27;--min_lr&#x27;, type=float, default=1e-05)</span><br><span class="line">parser.add_argument(&#x27;--warmup_lr&#x27;, type=float, default=1e-06)</span><br><span class="line">parser.add_argument(&#x27;--incremental_warmup_lr&#x27;, default=None)</span><br><span class="line">parser.add_argument(&#x27;--lr_noise_pct&#x27;, type=float, default=0.67)</span><br><span class="line">parser.add_argument(&#x27;--lr_noise_std&#x27;, type=float, default=1.0)</span><br><span class="line">parser.add_argument(&#x27;--lr_noise&#x27;, default=None)</span><br><span class="line">parser.add_argument(&#x27;--clip_grad&#x27;, type=float, default=None)</span><br><span class="line"></span><br><span class="line"># MODEL</span><br><span class="line">parser.add_argument(&#x27;--model&#x27;, type=str, default=&#x27;RVT&#x27;)</span><br><span class="line">parser.add_argument(&#x27;--drop&#x27;, type=float, default=0.0)</span><br><span class="line"># parser.add_argument(&#x27;--drop_rate&#x27;, type=float, default=0.1)</span><br><span class="line">parser.add_argument(&#x27;--drop_path&#x27;, type=float, default=0.1)</span><br><span class="line">parser.add_argument(&#x27;--patch_size&#x27;, type=int, default=4)</span><br><span class="line">parser.add_argument(&#x27;--depth&#x27;, default=[5])</span><br><span class="line">parser.add_argument(&#x27;--num_heads&#x27;, default=[12])</span><br><span class="line">parser.add_argument(&#x27;--embed_dim&#x27;, default=768, type=int)</span><br><span class="line">parser.add_argument(&#x27;--norm&#x27;, default=&quot;layer&quot;)</span><br><span class="line">parser.add_argument(&#x27;--pretrained&#x27;, default=False)</span><br><span class="line"></span><br><span class="line"># DATASET</span><br><span class="line">parser.add_argument(&#x27;--data_set&#x27;, default=&#x27;cifar&#x27;, choices=[&#x27;CIFAR&#x27;, &#x27;IMNET&#x27;, &#x27;INAT&#x27;, &quot;INAT19&quot;, &#x27;tinyimagenet200&#x27;], type=str)</span><br><span class="line">parser.add_argument(&#x27;--data_path&#x27;, type=str, default=&#x27;./cifar_10&#x27;)</span><br><span class="line">parser.add_argument(&#x27;--data_path_subTrain&#x27;, type=str, default=&#x27;&#x27;)</span><br><span class="line">parser.add_argument(&#x27;--data_path_subVal&#x27;, type=str, default=&#x27;&#x27;)</span><br><span class="line">parser.add_argument(&#x27;--initial_increment&#x27;, type=int, default=10)</span><br><span class="line">parser.add_argument(&#x27;--increment&#x27;, type=int, default=10)</span><br><span class="line">parser.add_argument(&#x27;--batch_size&#x27;, default=512, type=int)</span><br><span class="line">parser.add_argument(&#x27;--num_workers&#x27;, default=10, type=int)</span><br><span class="line">parser.add_argument(&#x27;--pin_mem&#x27;, default=True)</span><br><span class="line">parser.add_argument(&#x27;--ft_no_sampling&#x27;, default=False)</span><br><span class="line"></span><br><span class="line"># TRAIN</span><br><span class="line">parser.add_argument(&#x27;--epochs&#x27;, default=500, type=int)</span><br><span class="line">parser.add_argument(&#x27;--max_norm&#x27;, default=None)</span><br><span class="line">parser.add_argument(&#x27;--validation&#x27;, default=0.0, type=float)</span><br><span class="line"></span><br><span class="line">config.class_order = []</span><br><span class="line">with open(&#x27;class_order.txt&#x27;, &#x27;r&#x27;) as file:</span><br><span class="line">    for line in file:</span><br><span class="line">        config.class_order.append(int(line.split(&#x27;,&#x27;)[0]))</span><br></pre></td></tr></table></figure>

<p>model</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">con_embedding:</span><br><span class="line">class conv_embedding(nn.Module):</span><br><span class="line">    def __init__(self, in_channels, out_channels, patch_size):</span><br><span class="line">        super(conv_embedding, self).__init__()</span><br><span class="line">        self.out_channels = out_channels</span><br><span class="line">        self.proj = nn.Sequential(</span><br><span class="line">            nn.Conv2d(in_channels, 32, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1)),</span><br><span class="line">            nn.BatchNorm2d(32),</span><br><span class="line">            nn.MaxPool2d(3, stride=2, padding=1),</span><br><span class="line">            nn.Conv2d(32, out_channels, kernel_size=(4, 4), stride=(4, 4))</span><br><span class="line">        )</span><br><span class="line">        self.proj1 = nn.Conv2d(in_channels, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))</span><br><span class="line">        self.proj2 = nn.BatchNorm2d(32)</span><br><span class="line">        self.proj3 = nn.MaxPool2d(3, stride=2, padding=1)</span><br><span class="line">        self.proj4 = nn.Conv2d(32, out_channels, kernel_size=(2, 2), stride=(2, 2))</span><br><span class="line"></span><br><span class="line">    def forward(self, x):</span><br><span class="line">        x = self.proj1(x)</span><br><span class="line">        x = self.proj2(x)</span><br><span class="line">        x = self.proj3(x)</span><br><span class="line">        x = self.proj4(x)</span><br><span class="line">        # einops.rearrange is a reader-friendly smart element reordering for multidimensional tensors</span><br><span class="line">        x = rearrange(x, &#x27;b c h w -&gt; b (h w) c&#x27;)</span><br><span class="line">        return x</span><br></pre></td></tr></table></figure>

<p>logger</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Logger = logging.getLogger(&#x27;my log&#x27;)</span><br><span class="line">logging.basicConfig(filename=&#x27;train_main.txt&#x27;, format=&#x27;%(asctime)s - %(message)s&#x27;, level=logging.INFO)</span><br></pre></td></tr></table></figure>

<h2 id="ğŸ”¸-TinyImageNet100"><a href="#ğŸ”¸-TinyImageNet100" class="headerlink" title="ğŸ”¸ TinyImageNet100"></a>ğŸ”¸ TinyImageNet100</h2><p>config:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">parser = argparse.ArgumentParser()</span><br><span class="line"></span><br><span class="line">    # DEVICE and SEED</span><br><span class="line">    parser.add_argument(&#x27;--device&#x27;, default=&#x27;cuda&#x27;)</span><br><span class="line">    parser.add_argument(&#x27;--seed&#x27;, default=213, type=int)</span><br><span class="line"></span><br><span class="line">    # DISTRIBUTION</span><br><span class="line">    parser.add_argument(&#x27;--distributed&#x27;, default=False, type=bool)</span><br><span class="line"></span><br><span class="line">    # TRANSFORM</span><br><span class="line">    parser.add_argument(&#x27;--input_size&#x27;, type=int, default=64)</span><br><span class="line">    parser.add_argument(&#x27;--color_jitter&#x27;, default=0.4, type=float, metavar=&#x27;NAME&#x27;)</span><br><span class="line">    parser.add_argument(&#x27;--aa&#x27;, type=str, default=&#x27;rand-m9-mstd0.5-inc1&#x27;, metavar=&#x27;NAME&#x27;)</span><br><span class="line">    parser.add_argument(&#x27;--reprob&#x27;, type=float, default=0.0, metavar=&#x27;PCT&#x27;)</span><br><span class="line">    parser.add_argument(&#x27;--remode&#x27;, type=str, default=&#x27;pixel&#x27;)</span><br><span class="line">    parser.add_argument(&#x27;--recount&#x27;, type=int, default=1)</span><br><span class="line">    parser.add_argument(&#x27;--resplit&#x27;, default=False)</span><br><span class="line">    parser.add_argument(&#x27;--repeated_aug&#x27;, type=bool, default=True)</span><br><span class="line">    parser.add_argument(&#x27;--smoothing&#x27;, default=0.1, type=int)</span><br><span class="line">    parser.add_argument(&#x27;--train_interpolation&#x27;, default=&quot;bicubic&quot;, type=str)</span><br><span class="line"></span><br><span class="line">    # LOSS</span><br><span class="line">    parser.add_argument(&#x27;--lr&#x27;, default=0.0001, type=float)</span><br><span class="line">    parser.add_argument(&#x27;--incremental_lr&#x27;, type=float, default=0.0001)</span><br><span class="line">    parser.add_argument(&#x27;--distillation_t&#x27;, type=float, default=1.0)</span><br><span class="line">    parser.add_argument(&#x27;--no_amp&#x27;, default=True, action=&#x27;store_true&#x27;)</span><br><span class="line">    parser.add_argument(&#x27;--opt&#x27;, default=&#x27;adamw&#x27;)</span><br><span class="line">    parser.add_argument(&#x27;--weight_decay&#x27;, type=float, default=1e-06)</span><br><span class="line">    parser.add_argument(&#x27;--momentum&#x27;, type=float, default=0.9)</span><br><span class="line">    parser.add_argument(&#x27;--sched&#x27;, default=&#x27;cosine&#x27;)</span><br><span class="line">    parser.add_argument(&#x27;--opt_eps&#x27;, type=float, default=1e-08)</span><br><span class="line">    parser.add_argument(&#x27;--decay_epochs&#x27;, type=int, default=30)</span><br><span class="line">    parser.add_argument(&#x27;--warmup_epochs&#x27;, type=int, default=5)</span><br><span class="line">    parser.add_argument(&#x27;--cooldown_epochs&#x27;, default=10, type=int)</span><br><span class="line">    parser.add_argument(&#x27;--patience_epochs&#x27;, default=10, type=int)</span><br><span class="line">    parser.add_argument(&#x27;--decay_rate&#x27;, type=float, default=0.1)</span><br><span class="line">    parser.add_argument(&#x27;--min_lr&#x27;, type=float, default=1e-05)</span><br><span class="line">    parser.add_argument(&#x27;--warmup_lr&#x27;, type=float, default=1e-06)</span><br><span class="line">    parser.add_argument(&#x27;--incremental_warmup_lr&#x27;, default=None)</span><br><span class="line">    parser.add_argument(&#x27;--lr_noise_pct&#x27;, type=float, default=0.67)</span><br><span class="line">    parser.add_argument(&#x27;--lr_noise_std&#x27;, type=float, default=1.0)</span><br><span class="line">    parser.add_argument(&#x27;--lr_noise&#x27;, default=None)</span><br><span class="line">    parser.add_argument(&#x27;--clip_grad&#x27;, type=float, default=None)</span><br><span class="line"></span><br><span class="line">    # MODEL</span><br><span class="line">    parser.add_argument(&#x27;--model&#x27;, type=str, default=&#x27;RVT&#x27;)</span><br><span class="line">    parser.add_argument(&#x27;--drop&#x27;, type=float, default=0.0)</span><br><span class="line">    # parser.add_argument(&#x27;--drop_rate&#x27;, type=float, default=0.1)</span><br><span class="line">    parser.add_argument(&#x27;--drop_path&#x27;, type=float, default=0.1)</span><br><span class="line">    parser.add_argument(&#x27;--patch_size&#x27;, type=int, default=8)</span><br><span class="line">    parser.add_argument(&#x27;--depth&#x27;, default=[5])</span><br><span class="line">    parser.add_argument(&#x27;--num_heads&#x27;, default=[12])</span><br><span class="line">    parser.add_argument(&#x27;--embed_dim&#x27;, default=768, type=int)</span><br><span class="line">    parser.add_argument(&#x27;--norm&#x27;, default=&quot;layer&quot;)</span><br><span class="line">    parser.add_argument(&#x27;--pretrained&#x27;, default=False)</span><br><span class="line"></span><br><span class="line">    # DATASET</span><br><span class="line">    parser.add_argument(&#x27;--data_set&#x27;, default=&#x27;tinyimagenet200&#x27;, choices=[&#x27;CIFAR&#x27;, &#x27;IMNET&#x27;, &#x27;INAT&#x27;, &quot;INAT19&quot;, &#x27;tinyimagenet200&#x27;], type=str)</span><br><span class="line">    parser.add_argument(&#x27;--data_path&#x27;, type=str, default=&#x27;./tiny_imagenet&#x27;)</span><br><span class="line">    parser.add_argument(&#x27;--data_path_subTrain&#x27;, type=str, default=&#x27;&#x27;)</span><br><span class="line">    parser.add_argument(&#x27;--data_path_subVal&#x27;, type=str, default=&#x27;&#x27;)</span><br><span class="line">    parser.add_argument(&#x27;--initial_increment&#x27;, type=int, default=10)</span><br><span class="line">    parser.add_argument(&#x27;--increment&#x27;, type=int, default=10)</span><br><span class="line">    # parser.add_argument(&#x27;--class_order&#x27;, default=None, type=int, nargs=&#x27;+&#x27;)</span><br><span class="line">    parser.add_argument(&#x27;--batch_size&#x27;, default=256, type=int)</span><br><span class="line">    parser.add_argument(&#x27;--num_workers&#x27;, default=4, type=int)</span><br><span class="line">    parser.add_argument(&#x27;--pin_mem&#x27;, default=True)</span><br><span class="line">    parser.add_argument(&#x27;--ft_no_sampling&#x27;, default=False)</span><br><span class="line"></span><br><span class="line">    # TRAIN</span><br><span class="line">    parser.add_argument(&#x27;--epochs&#x27;, default=500, type=int)</span><br><span class="line">    parser.add_argument(&#x27;--max_norm&#x27;, default=None)</span><br><span class="line">    parser.add_argument(&#x27;--validation&#x27;, default=0.0, type=float)</span><br></pre></td></tr></table></figure>

<p>model:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">class conv_embedding(nn.Module):</span><br><span class="line">    def __init__(self, in_channels, out_channels, patch_size):</span><br><span class="line">        super(conv_embedding, self).__init__()</span><br><span class="line">        self.out_channels = out_channels</span><br><span class="line">        self.proj = nn.Sequential(</span><br><span class="line">            nn.Conv2d(in_channels, 32, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1)),</span><br><span class="line">            nn.BatchNorm2d(32),</span><br><span class="line">            nn.MaxPool2d(3, stride=2, padding=1),</span><br><span class="line">            nn.Conv2d(32, out_channels, kernel_size=(4, 4), stride=(4, 4))</span><br><span class="line">        )</span><br><span class="line">        self.proj1 = nn.Conv2d(in_channels, 32, kernel_size=(3, 3), stride=(2, 2), padding=(2, 2))</span><br><span class="line">        self.proj2 = nn.BatchNorm2d(32)</span><br><span class="line">        self.proj3 = nn.MaxPool2d(3, stride=2, padding=1)</span><br><span class="line">        self.proj4 = nn.Conv2d(32, out_channels, kernel_size=(2, 2), stride=(2, 2))</span><br><span class="line"></span><br><span class="line">    def forward(self, x):</span><br><span class="line">        x = self.proj1(x)</span><br><span class="line">        x = self.proj2(x)</span><br><span class="line">        x = self.proj3(x)</span><br><span class="line">        x = self.proj4(x)</span><br><span class="line">        # einops.rearrange is a reader-friendly smart element reordering for multidimensional tensors</span><br><span class="line">        x = rearrange(x, &#x27;b c h w -&gt; b (h w) c&#x27;)</span><br><span class="line">        return x</span><br></pre></td></tr></table></figure>

<p>logger:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Logger = logging.getLogger(&#x27;my log&#x27;)</span><br><span class="line">logging.basicConfig(filename=&#x27;train_main_imnet.txt&#x27;, format=&#x27;%(asctime)s - %(message)s&#x27;, level=logging.INFO)</span><br></pre></td></tr></table></figure>

<h2 id="ğŸ”¸-ImageNet100"><a href="#ğŸ”¸-ImageNet100" class="headerlink" title="ğŸ”¸ ImageNet100"></a>ğŸ”¸ ImageNet100</h2><p>config:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"></span><br><span class="line">model</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">## ğŸ”¸ FCS train info</span><br></pre></td></tr></table></figure>
<p>CIFAR100-5stages<br>83.92, 74.85, 70.77, 67.04, 63.66, 62.13<br>CIFAR100-10stages<br>83.92, 77.33, 73.67, 71.4, 69.66, 67.72, 66.22, 64.53, 62.66, 61.91, 60.39<br>CIFAR100-20stages<br>84.58, 78.42, 77.89, 76.49, 75.25, 73.07, 72.16, 70.43, 68.19, 68.04, 67.57, 66.6, 66.21, 64.66, 63.24, 62.64, 61.62, 60.89, 59.93, 59.24, 58.36<br>Tiny-ImageNet-5stages<br>65.6, 55.95, 54.56, 51.4, 48.43, 46.04<br>Tiny-ImageNet-10stages<br>65.6, 57.89, 55.27, 54.49, 52.74, 51.92, 50.26, 49.01, 47.77, 46.86, 44.95<br>Tiny-ImageNet-20stages<br>64.88, 58.88, 58.07, 55.34, 54.67, 55.26, 53.68, 53.05, 52.34, 51.89, 50.25, 49.92, 48.8, 48.96, 47.82, 47.21, 46.1, 46.01, 44.76, 43.74, 42.57<br>ImageNet-Subset-10stages<br>84.48, 79.13, 75.4, 73.05, 71.63, 69.87, 68.35, 66.07, 64.56, 63.07, 61.76</p>
<pre><code>
https://image-net.org/data/ILSVRC/2012/ILSVRC2012_img_train.tar

https://image-net.org/data/ILSVRC/2012/ILSVRC2012_img_val.tar
</code></pre>
  
    </div> 

    
        <!-- Division Line -->
        <div class="division"></div> 
    

    <div class="post-info-wrapper">
            
                    <!-- Post Info -->
                    <p class="post-date">2025-01-07</p>
                    
                    
                        <p class="post-info-categories">
                            
                        </p>
                    

                    
                        <p class="post-info-tags">
                            
                        </p>
                    
            
    </div>
</article>


    

            </main>

            <!-- 'To Top' Btn-->
            
                <div id="to-top">
    <a href="#top" class="toTop">
        <i class="fa fa-pagelines"></i>
    </a>
</div>
            

            <!-- Footer -->
            
                <footer class="footer-wrapper col-xs-12 col-sm-12">
    <div class="footer-banner-wrapper">
        <p class="footer-banner">Powered by <a target="_blank" rel="noopener" href="https://hexo.io/" title="Hexo">Hexo</a></p>
        <P class="footer-banner">Theme <a target="_blank" rel="noopener" href="https://github.com/Lonezj/hexo-theme-wind" title="Wind">wind</a></P>
    </div>
</footer>
            
        </div>
    </body>
</html>